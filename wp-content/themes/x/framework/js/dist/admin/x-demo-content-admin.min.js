jQuery(function(t){var e,s,n;e=function(){this.$el=t(this.markup),this.$message=this.$el.find(".progress-content-title"),this.$bar=this.$el.find(".progress-content-bar-inner")},t.extend(e.prototype,{markup:'<div class="progress-outer"><div class="progress-inner"><div class="progress-content"><div class="progress-content-title"></div><div class="progress-content-bar-outer"><div class="progress-content-bar-inner"></div></div></div><div class="progress-complete"><div class="progress-complete-icon dashicons dashicons-yes"></div><div class="progress-complete-title">'+xDemoContent.complete+"</div></div></div></div>",start:function(){this.message(xDemoContent.start),t(".x-addons-demo-content").prepend(this.$el),this.setProgress(0)},message:function(t){this.$message.html(t)},setProgress:function(t){t=.9*t+.1,this.$bar.css("width",Math.round(100*t)+"%")},simulateProgress:function(){this.message(xDemoContent.simulated),this.$bar.animate({width:"80%"},250)},complete:function(){this.message("&nbsp;"),this.$bar.animate({width:"100%"},250),setTimeout(function(){this.$el.addClass("complete"),this.close()}.bind(this),400)},fail:function(t){this.message(t),this.close()},close:function(){this.$el.delay(1500).fadeOut(250),setTimeout(function(){this.$el.detach().removeClass("complete").show(),this.setProgress(0),this.message("")}.bind(this),2e3)}}),s=function(){},t.extend(s.prototype,{init:function(e,s){return this.data=e,this.data.action=s?"x_demo_importer":"x_demo_content_setup",this.data.attempts=1,s?(this.data.session="s_"+Math.round((new Date).getTime()+100*Math.random()),n.start(),t("#x-addons-demo-content-submit").prop("disabled",!0),void this.acknowledge({data:{},first:!0})):this.runStandard()},runStandard:function(){n.start(),n.simulateProgress(),t("#x-addons-demo-content-submit").prop("disabled",!0),this.standardProcess(function(e){return e.success===!1?this.failure(e.data.message,e):(n.complete(),void t("#x-addons-demo-content-submit").prop("disabled",!1))}.bind(this))},standardProcess:function(t){jQuery.post(ajaxurl,this.data,t).fail(function(e){return n.message(this.timeOutMessage(this.data.attempts++)),this.data.attempts>=25?this.failure(xDemoContent.failure,e):void this.standardProcess(t)}.bind(this))},acknowledge:function(t){if(t.data||t.first){if(this.data.attempts=0,0==t.success)return this.failure(t.data.message,t.data);if(t.data.message&&n.message(t.data.message),t.data.debug_message&&xDemoContent.debug&&console.log("X Demo Debug",t.data.debug_message,t.data.debug||null),t.data.completion&&t.data.completion===!0)return t.data.debug&&xDemoContent.debug&&console.log(t.data.debug),this.complete();t.data.completion&&n.setProgress(t.data.completion.ratio)}else if(n.message(this.timeOutMessage(this.data.attempts++)),this.data.attempts>25)return this.failure(xDemoContent.failure,t);setTimeout(function(){jQuery.post(ajaxurl,this.data).always(this.acknowledge.bind(this))}.bind(this),40*this.data.attempts)},complete:function(){n.complete(),t("#x-addons-demo-content-submit").prop("disabled",!1)},failure:function(e,s){n.fail(e),t("#x-addons-demo-content-submit").prop("disabled",!1),console.error("X Demo Importer failure",s||{})},timeOutMessage:function(t){return t>20?xDemoContent.timeout3:t>10?xDemoContent.timeout2:xDemoContent.timeout1}}),n=new e,importer=new s,t(".x-demo-select").on("click change",function(){var e,s,n,a;t(".x-addons-postbox .content").removeClass("selected"),e=t(this).parent().parent(),s=t(this).find("option:selected"),e.find(".demo-content-link").attr("href",s.data("demo-url")),e.addClass("selected"),n="standard-demo"==t(this).attr("name")?"standard":"expanded",a="standard"==n?xDemoContent.buttonStandard:xDemoContent.buttonExpanded,t("#x-addons-demo-content-submit").val(a.replace("%s",s.html())),t('input[name="demo_type"]').val(n)}),t("form").on("submit",function(e){var s,n;e.preventDefault(),n=t(this).find('input[name="demo_type"]').val(),s={demo:t(this).find('select[name="'+n+'-demo"]').val()},"standard"==n&&(s.standard_posts=t(this).find('input[name="posts"]:checked').val()||"no",s.standard_portfolio_items=t(this).find('input[name="portfolio-items"]:checked').val()||"no"),xAdminConfirm("error",xDemoContent.confirm,function(){importer.init(s,"expanded"==n)})})});